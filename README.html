<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="SQL queries Activities">
<title>SQL Activity 1 to 3 | 2.07</title>
<style>

</style>
</head>
<body class="article data-line-1">
<div id="header">
<h1>SQL Activity 1 to 3 | 2.07</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock data-line-49">
<div class="content">
<img src="https://user-images.githubusercontent.com/23629340/40541063-a07a0a8a-601a-11e8-91b5-2f13e4e6b441.png" alt="40541063 a07a0a8a 601a 11e8 91b5 2f13e4e6b441" width="70">
</div>
</div>
<div class="paragraph data-line-51">
<p>Jorge Castro DAPT NOV2021</p>
</div>
<div class="exampleblock data-line-53">
<div class="content">
<hr>
</div>
</div>
<div class="paragraph data-line-56">
<p>SQL queries Activities</p>
</div>
<div id="toc" class="data-line-58">
<div id="toctitle" class="title">Activities | Description:</div>
<ul class="sectlevel1">
<li><a href="#_activity">Activity:</a></li>
<li><a href="#_activity_2">Activity:</a></li>
<li><a href="#_activity_3">Activity:</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1 data-line-62">
<h2 id="_activity">Activity:</h2>
<div class="sectionbody">
<div class="ulist data-line-63">
<ul>
<li class="data-line-63">
<p>In this activity, we will be using the <code>bank</code> database.</p>
<div class="ulist data-line-65">
<ul>
<li class="data-line-65">
<p>Find out how many cards of each type have been issued.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-69">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-70">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    count(*) AS number_of_cards_issued,
    `type`
FROM
    card
GROUP BY
    `type`;</code></pre>
</div>
</div>
<div class="imageblock data-line-79">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147841361-f1183fb9-2225-4992-81f8-e12747e68e4f.png" alt="147841361 f1183fb9 2225 4992 81f8 e12747e68e4f" width="600">
</div>
</div>
<div class="exampleblock data-line-81">
<div class="content">
<hr>
</div>
</div>
<div class="ulist data-line-86">
<ul>
<li class="data-line-86">
<p>Find out how many customers there are by the district.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-88">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-90">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    count(*) AS number_of_clients,
    district.a2 AS district_name
FROM
    `client`
    INNER JOIN district ON `client`.district_id = district.A1
GROUP BY
    2
ORDER BY
    1 DESC;</code></pre>
</div>
</div>
<div class="imageblock data-line-103">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147839479-0fa51f8d-768f-4d4d-adad-f2ae785f2050.png" alt="147839479 0fa51f8d 768f 4d4d adad f2ae785f2050" width="700">
</div>
</div>
<div class="exampleblock data-line-105">
<div class="content">
<hr>
</div>
</div>
<div class="ulist data-line-109">
<ul>
<li class="data-line-109">
<p>Find out average transaction value by type.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-111">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-113">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    floor(avg(amount)) AS average_transact_amount,
    `type`
FROM
    trans
GROUP BY
    2;</code></pre>
</div>
</div>
<div class="imageblock data-line-123">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147839677-6db353ea-58f7-4b87-a106-cc01ba2404c2.png" alt="147839677 6db353ea 58f7 4b87 a106 cc01ba2404c2" width="700">
</div>
</div>
</div>
</div>
<div class="sect1 data-line-127">
<h2 id="_activity_2">Activity:</h2>
<div class="sectionbody">
<div class="ulist data-line-129">
<ul>
<li class="data-line-129">
<p>As you might have seen in the previous query, there are 19 rows returned by this query. But there a few places where the column <code>k_symbol</code> is an empty string. Your task it to use a filter to remove those rows of data. After the filter gets applied, you would see that the number of rows have reduced.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-131">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-133">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    k_symbol,
    floor(avg(amount)) AS average_transact_amount
FROM
    trans
WHERE
    k_symbol != ' '
GROUP BY
    1;</code></pre>
</div>
</div>
<div class="imageblock data-line-145">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147840151-f4de4b4a-010c-43a2-9f82-98d00fd85d8c.png" alt="147840151 f4de4b4a 010c 43a2 9f82 98d00fd85d8c" width="700">
</div>
</div>
</div>
</div>
<div class="sect1 data-line-148">
<h2 id="_activity_3">Activity:</h2>
<div class="sectionbody">
<div class="ulist data-line-149">
<ul>
<li class="data-line-149">
<p>Find the districts with more than 100 clients. (Keep using the bank database.)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-151">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-153">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    count(*) AS number_of_clients,
    district.a2 AS district_name
FROM
    `client`
    INNER JOIN district ON `client`.district_id = district.A1
GROUP BY
    2
HAVING
    number_of_clients &gt;= 100
ORDER BY
    1 DESC;</code></pre>
</div>
</div>
<div class="imageblock data-line-168">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147841024-7fd35a48-087c-4e2d-83c3-7e2f104acc2e.png" alt="147841024 7fd35a48 087c 4e2d 83c3 7e2f104acc2e" width="700">
</div>
</div>
<div class="exampleblock data-line-170">
<div class="content">
<hr>
</div>
</div>
<div class="ulist data-line-176">
<ul>
<li class="data-line-176">
<p>Find the transactions (type, operation) with a mean amount greater than 10000.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-178">
<p><code>Answer:</code></p>
</div>
<div class="listingblock data-line-180">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">SELECT
    `type`,
    operation,
    floor(avg(amount)) AS average_amount
FROM
    trans
GROUP BY
    1,
    2
HAVING
    average_amount &gt; 10000;</code></pre>
</div>
</div>
<div class="imageblock data-line-194">
<div class="content">
<img src="https://user-images.githubusercontent.com/63274055/147841288-a949fc52-9145-46e1-b57c-56379f664aa3.png" alt="147841288 a949fc52 9145 46e1 b57c 56379f664aa3" width="700">
</div>
</div>
<div class="paragraph data-line-197">
<p><a href="https://github.com/jecastrom/data_2.07_activities/blob/7abfb6a0375c2c4ad3021f3f9a388a495142e1a8/files_for_actitity/act%202.07%20solutions.sql" data-href="https://github.com/jecastrom/data_2.07_activities/blob/7abfb6a0375c2c4ad3021f3f9a388a495142e1a8/files_for_actitity/act%202.07%20solutions.sql">Solutions script only</a></p>
</div>
<div class="exampleblock data-line-199">
<div class="content">
<hr>
</div>
</div>
<div class="paragraph data-line-203">
<p>Back to <a href="#_activity">Activity:</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-01-01 02:18:09 +0100
</div>
</div>
</body>
</html>